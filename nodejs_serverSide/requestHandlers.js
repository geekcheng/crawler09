var conndb = require("./conndb.js");
var bufferhelper=require("./bufferhelper.js");
function saveData(response,datas){
	//分割字符串，组装成json
	var s= datas.split("&");

	var url=decodeURIComponent(s[0].toString().split("=")[1]);
	var data=decodeURIComponent(s[1].toString().split("=")[1]);
	//下面的url,data,hrefs应该用循环来取，可是s[2]有问题，有待优化
	var hrefs=decodeURIComponent(s[2].toString().split("=")[1]);
	var docs={"url":url,"c_page":decodeURIComponent(data)}
	var seeds={"hrefs":hrefs};
	
	conndb.saveDoc(docs);
	conndb.saveSeeds(seeds);
	response.writeHead(200,{"Content-Type":"text/html"});
	response.write("data saved.");
	response.end();
}
function start(response){
console.log("start is active.");
  var body = '<html>'+
    '<head>'+
    '<meta http-equiv="Content-Type" content="text/html; '+
    'charset=UTF-8" />'+
    '</head>'+
    '<body>'+
    '<form action="/ajax" method="post">'+
    '<input type="text" name="ajaxs">'+
    '<input type="submit" value="提交" />'+
    '</form>'+
    '</body>'+
    '</html>';
    response.writeHead(200, {"Content-Type": "text/html;charset=utf-8"});
    response.write(body);
    response.end();
}

function returnSeeds(response){
	var sss;
	console.log("----------------------------------------------------");
	console.log(conndb.getSeeds(sss));
	console.log("----------------------------------------------------");
	var seeds="hrefs: 'http://www.oschina.net/,http://www.oschina.net/project,http://www.oschina.net/question,http://www.oschina.net/question?catalog=1,http://www.oschina.net/question?catalog=2,http://www.oschina.net/question?catalog=3,http://www.oschina.net/question?catalog=100,http://www.oschina.net/question?catalog=4,http://www.oschina.net/alipay,http://www.oschina.net/code/list,http://www.oschina.net/blog,http://www.oschina.net/translate,http://www.oschina.net/news,http://www.oschina.net/android,http://www.oschina.net/android,http://www.oschina.net/ios/home,http://www.oschina.net/ios/codingList,http://www.oschina.net/wp7,http://www.oschina.net/job,http://www.oschina.net/home/login?goto_page=http%3A%2F%2Fwww.oschina.net%2F,http://www.oschina.net/home/reg,http://www.oschina.net/,http://www.oschina.net/project,http://www.oschina.net/project/zh,http://www.oschina.net/project/tags,http://www.oschina.net/project/list?sort=time,http://www.oschina.net/code/list,http://www.oschina.net/code/list/1/java,http://www.oschina.net/code/list/4/php,http://www.oschina.net/code/list/2/cpp,http://www.ostools.net/,http://runjs.cn/,http://www.ostools.net/apidocs,http://www.oschina.net/code/explore,http://www.oschina.net/events,http://www.oschina.net/question/tag/%E9%AB%98%E6%89%8B%E9%97%AE%E7%AD%94,http://www.oschina.net/question/tag/%E5%BC%80%E6%BA%90%E8%AE%BF%E8%B0%88,http://www.oschina.net/doc,http://www.oschina.net/android,http://www.oschina.net/ios/home,http://www.oschina.net/wp7,http://www.oschina.net/app,http://www.oschina.net/news/list?show=industry,http://www.oschina.net/news/list?show=industry,http://www.oschina.net/news/39516/jetbrains-tools-preferential,http://my.oschina.net/noahxiao/blog/126357,http://www.oschina.net/news/40036/pure-css3-navigation-menu-generators-and-tutorials,http://www.oschina.net/translate/everything-about-java-8,http://www.oschina.net/translate/8-reasons-to-choose-commercial-library-instead-of-opensource,http://www.oschina.net/news/40027/6-opensource-ocr-tools,http://www.oschina.net/translate/introducing-ext-js-4-2,http://www.oschina.net/news/40022/wildfly,http://www.oschina.net/news/40020/programmer-sale-apples,http://www.oschina.net/news/40018/android-jailbreak,http://www.oschina.net/news/40017/qihoo-360-will-appeal,http://www.oschina.net/p/google-glass-kernel-source,http://www.oschina.net/translate/9_fallacies_java_performance,http://my.oschina.net/feichexia/blog/126017,http://www.oschina.net/news/40006/360-lose-in-lawsuit-with-baidu,http://www.oschina.net/news/40004/occupational-disease,http://www.oschina.net/news/40002/things-internet-dba-should-know,http://www.oschina.net/news/40000/disagreement-between-founder,http://www.oschina.net/news/39999/osc-htpasswd,http://www.oschina.net/news/39995/github-donates-private-repositories-to-women,http://www.oschina.net/news/39993/dont-be-office-old-things,http://www.oschina.net/news/39992/we-not-work-for-social-networking-disable,http://www.oschina.net/news/39991/nginx-source-repository-move-to-mercurial,http://www.oschina.net/news/39989/chrome-plugin-to-read-office-documents,http://www.oschina.net/news/39988/ios-vpn-never-change,http://my.oschina.net/zino/blog/125689,http://www.oschina.net/news/39978/this-is-what-a-ddos-attack-looks-like-1552975,http://www.oschina.net/news/39977/ubuntu-server-13-04-advances-with-openstack,http://www.oschina.net/translate/open-source-physics-linux,http://www.oschina.net/news/39974/ping-whole-internet,/news/39973/ngx_http_close_connection-integer-overflow,http://www.oschina.net/news/list?show=project,http://www.oschina.net/news/list?show=project,http://www.oschina.net/news/39938/ubuntu-13-04,http://www.oschina.net/news/40042/linux-kernel-3-9-final,http://www.oschina.net/news/40041/libzip-0-11-1,http://www.oschina.net/news/40040/galculator-2-1-1,http://www.oschina.net/news/40039/gamgi-0-16-4,http://www.oschina.net/news/40038/atunes-3-0-9,http://www.oschina.net/news/40035/thesss-6-0,http://www.oschina.net/news/40034/apache-camel-2-9-7,http://www.oschina.net/news/40033/gdb-7-6,http://www.oschina.net/news/40032/jooq-3-0-final,http://www.oschina.net/news/40031/rsyntaxtextarea-2-0-7,http://www.oschina.net/news/40030/sudokuki-1-2,http://www.oschina.net/news/40026/descent-os-4-0,http://www.oschina.net/news/40025/blender-2-67-rc,http://www.oschina.net/news/40024/fxmoviemanager-6-3,http://www.oschina.net/news/40021/resin-4-0-36,http://www.oschina.net/news/40019/fineui-3-2-5,http://www.oschina.net/news/40015/google_is_testing_android_4_3,http://www.oschina.net/news/40014/phpmyadmin-4-0-rc4,http://www.oschina.net/news/40013/macwire-0-2-scala-di,http://www.oschina.net/news/40012/graphene_2_0_0_alpha4_released,http://www.oschina.net/news/40009/yocto-project-1-4-dylan,http://www.oschina.net/news/40008/kdevelop-4-5,http://www.oschina.net/news/40007/zend-framework-models-generator-3-0,http://www.oschina.net/news/40005/blackholej-1-1-3,http://www.oschina.net/news/40003/mysql-for-excel,http://www.oschina.net/news/40001/semplice-linux-4-0-0,http://www.oschina.net/news/39998/jieba-0-28,http://www.oschina.net/news/39997/openresty-1-2-8-1,http://www.oschina.net/news/39994/sanewall-1-0-linux-firewall-builder,http://www.oschina.net/news/39986/ballroomdj-1-6,http://www.aliyun.com/cps/channel?channel_id=1132&user=0&lv=1,http://www.oschina.net/code/step1,http://www.oschina.net/code/list,http://www.oschina.net/code/list/1/java?sort=time,http://www.oschina.net/code/list/4/php?sort=time,http://www.oschina.net/code/list/9/javascript?sort=time,http://www.oschina.net/code/list/2/cpp?sort=time,http://www.oschina.net/code/list/3/csharp?sort=time,http://www.oschina.net/code/list/6/ruby?sort=time,http://www.oschina.net/code/list/7/python?sort=time,http://www.oschina.net/code/list/5/perl?sort=time,http://www.oschina.net/code/list/12/scala?sort=time,http://www.oschina.net/code/tag/%E7%B2%BE%E5%8D%8E,http://www.oschina.net/code/tag/oschina,http://www.oschina.net/code/list/43/android,http://www.oschina.net/code/search?q=QT,http://www.oschina.net/code/tag/hibernate,http://www.oschina.net/code/list/128/ajax,http://www.oschina.net/code/search?q=%E6%B8%B8%E6%88%8F,http://www.oschina.net/code/snippet_778875_20910,http://www.oschina.net/code/snippet_1035394_20909,http://www.oschina.net/code/snippet_863768_20908,http://www.oschina.net/code/snippet_736055_20906,http://www.oschina.net/code/snippet_615783_20905,http://www.oschina.net/code/snippet_726667_20904,http://www.oschina.net/code/snippet_436266_20903,http://www.oschina.net/code/snippet_1029551_20901,http://www.oschina.net/code/snippet_780719_20900,http://www.oschina.net/code/snippet_1017384_20898,http://www.oschina.net/code/snippet_871112_20764,http://www.oschina.net/code/snippet_263253_20500,http://www.oschina.net/code/snippet_58387_20726,http://www.oschina.net/code/snippet_251883_20723,http://www.oschina.net/code/snippet_86510_20734,http://www.oschina.net/code/snippet_176050_20653,http://www.oschina.net/code/snippet_1021320_20666,http://www.oschina.net/code/snippet_699222_20859,http://www.oschina.net/code/snippet_699222_20721,http://www.oschina.net/code/snippet_947432_20759,http://www.oschina.net/question/ask,http://www.oschina.net/question,http://www.oschina.net/question?catalog=1,http://www.oschina.net/question?catalog=2,http://www.oschina.net/question?catalog=3,http://www.oschina.net/question?catalog=100,http://www.oschina.net/question?catalog=4,http://www.oschina.net/question/tag/OSCHINA%E5%8E%9F%E5%88%9B%E7%BF%BB%E8%AF%91,http://www.oschina.net/question/tag/oschina,http://www.oschina.net/question/tag/java,http://www.oschina.net/question/tag/cpp,http://www.oschina.net/question/tag/php,http://www.oschina.net/question/tag/python,http://www.oschina.net/question/tag/linux,http://www.oschina.net/android,http://www.oschina.net/ios,http://www.oschina.net/question/tag/mysql,http://www.oschina.net/question/12_106453,http://www.oschina.net/question/1024729_104025,http://www.oschina.net/question/12_7806,http://www.oschina.net/question/1037196_108821,http://www.oschina.net/question/1033853_108594,http://www.oschina.net/question/815945_108824,http://www.oschina.net/question/1043107_108823,http://www.oschina.net/question/1037950_108601,http://www.oschina.net/question/1042674_108608,http://www.oschina.net/question/781584_108809,http://www.oschina.net/question/931988_108805,http://www.oschina.net/question/207779_108822,http://www.oschina.net/question/203191_108820,http://www.oschina.net/question/580695_108625,http://www.oschina.net/question/1043021_108819,http://www.oschina.net/question/203191_108818,http://www.oschina.net/question/56900_108811,http://www.oschina.net/question/614279_108789,http://www.oschina.net/question/437244_108815,http://www.oschina.net/question/583625_108814,http://www.oschina.net/question/1038270_108636,http://www.oschina.net/question/1010995_108788,http://www.oschina.net/question/615846_108813,http://www.oschina.net/question/656608_108812,http://www.oschina.net/question/155363_108465,http://www.oschina.net/question/1043064_108810,http://www.oschina.net/question/222809_108744,http://www.oschina.net/question/1023658_108750,http://www.oschina.net/question/1036705_108791,http://www.oschina.net/question/137371_108795,http://www.oschina.net/question/1016893_108787,http://www.oschina.net/question/569120_108799,http://www.oschina.net/question/922543_108800,http://www.oschina.net/question/1037950_108794,http://www.oschina.net/question/940802_108797,http://www.oschina.net/question/856462_108747,http://www.oschina.net/question/1014689_108793,http://www.oschina.net/question/1042505_108733,http://www.oschina.net/question/88379_108473,http://www.oschina.net/question/569785_108762,http://www.oschina.net/question/819401_108792,http://www.oschina.net/question/147333_108785,http://www.oschina.net/question/1043000_108790,http://www.oschina.net/question/876307_108786,http://www.oschina.net/question/96889_108675,http://www.oschina.net/question/244891_108658,http://www.oschina.net/question/1039238_108583,http://www.oschina.net/question/96889_108693,http://www.oschina.net/question/1023658_108753,http://www.oschina.net/question/877595_108746,http://www.oschina.net/question/257479_108743,http://www.oschina.net/question/1034530_108694,http://www.oschina.net/question/1016890_108742,http://www.oschina.net/question/110101_108738,http://www.oschina.net/question/994439_108571,http://www.oschina.net/question/1016890_108679,http://www.oschina.net/question/577137_108712,http://www.oschina.net/question/616294_108686,http://www.oschina.net/question/1026760_108699,http://www.oschina.net/question/436693_108490,http://www.oschina.net/question,http://www.oschina.net/job,http://www.oschina.net/job,http://www.oschina.net/job/?addr_prv=北京,http://www.oschina.net/job/?addr_prv=上海,http://www.oschina.net/job/?addr_prv=重庆,http://www.oschina.net/job/?addr_prv=广东&addr_city=%E5%B9%BF%E5%B7%9E,http://www.oschina.net/job/?addr_prv=广东&addr_city=%E6%B7%B1%E5%9C%B3,http://www.oschina.net/job/?addr_prv=浙江&addr_city=%E6%9D%AD%E5%B7%9E,http://www.oschina.net/job/?addr_prv=江苏&addr_city=%E5%8D%97%E4%BA%AC,http://www.oschina.net/job/?addr_prv=四川&addr_city=%E6%88%90%E9%83%BD,http://www.oschina.net/job/?addr_prv=福建&addr_city=%E5%8E%A6%E9%97%A8,http://www.oschina.net/job/?addr_prv=辽宁&addr_city=%E5%A4%A7%E8%BF%9E,http://www.oschina.net/job/?addr_prv=湖北&addr_city=%E6%AD%A6%E6%B1%89,http://www.oschina.net/job/?addr_prv=湖南&addr_city=%E9%95%BF%E6%B2%99,http://www.oschina.net/job/detail/238589_5486,http://www.oschina.net/job/detail/1042871_5517,http://www.oschina.net/job/detail/817200_5516,http://www.oschina.net/job/detail/925948_5515,http://www.oschina.net/job/detail/1042441_5514,http://www.oschina.net/job/detail/186579_5512,http://www.oschina.net/job/detail/1041218_5511,http://www.oschina.net/job/detail/1033712_5510,http://www.oschina.net/job/detail/1041876_5502,http://www.oschina.net/job/detail/1029903_5498,http://www.oschina.net/job/detail/1041885_5495,http://www.oschina.net/job/detail/216781_5493,http://www.oschina.net/job/detail/1041354_5492,http://www.oschina.net/job/detail/1041795_5491,http://www.oschina.net/job/detail/1041660_5490,http://www.oschina.net/job,http://www.oschina.net/question/ask?catalog=100,http://www.oschina.net/question?catalog=100,http://www.oschina.net/question/166715_108798,http://www.oschina.net/question/942930_108466,http://www.oschina.net/question/1000353_108796,http://www.oschina.net/question/817537_108729,http://www.oschina.net/question/228798_108491,http://www.oschina.net/question/943645_108678,http://www.oschina.net/question/203191_108312,http://www.oschina.net/question/565465_108145,http://www.oschina.net/question/922543_108078,http://www.oschina.net/question/257445_107425,http://www.oschina.net/question?catalog=100,http://www.oschina.net/shop/jetbrains,http://my.oschina.net/dlpinghailinfeng,http://my.oschina.net/dlpinghailinfeng,http://my.oschina.net/dlpinghailinfeng/tweet/1933564,http://my.oschina.net/daotianya,http://my.oschina.net/daotianya,http://my.oschina.net/daotianya/tweet/1933563,http://my.oschina.net/feichexia,http://my.oschina.net/feichexia,http://my.oschina.net/feichexia/tweet/1933559,http://my.oschina.net/skyhacker2,http://my.oschina.net/skyhacker2,http://my.oschina.net/skyhacker2/tweet/1933547,http://my.oschina.net/javaEEdev,http://my.oschina.net/javaEEdev,http://my.oschina.net/javaEEdev/tweet/1933543,http://my.oschina.net/javayou,http://my.oschina.net/javayou,http://my.oschina.net/javayou/tweet/1924678,http://my.oschina.net/kingofdown,http://my.oschina.net/kingofdown,http://my.oschina.net/kingofdown/tweet/1923449,http://my.oschina.net/marcocyyu,http://my.oschina.net/marcocyyu,http://my.oschina.net/marcocyyu/tweet/1926568,http://my.oschina.net/javayou,http://my.oschina.net/javayou,http://my.oschina.net/javayou/tweet/1924966,http://my.oschina.net/samshuai,http://my.oschina.net/samshuai,http://my.oschina.net/samshuai/tweet/1927284,http://www.oschina.net/avascript:;,http://www.oschina.net/avascript:;,http://www.oschina.net/tweets,http://www.oschina.net/p/charisma,http://www.oschina.net/p/bootstrap,http://www.oschina.net/p/charisma,http://www.oschina.net/p/openemu,http://www.oschina.net/p/tsar,http://www.oschina.net/p/androrat,http://www.oschina.net/p/pushsharp,http://www.oschina.net/project/weekly_projects,http://www.oschina.net/blog,http://my.oschina.net/Kenyon/blog/126360,http://my.oschina.net/noahxiao/blog/126357,http://my.oschina.net/solu/blog/126290,http://my.oschina.net/chengye/blog/126286,http://my.oschina.net/xishuixixia/blog/126166,http://my.oschina.net/iamjiuye/blog/126126,http://my.oschina.net/flashsword/blog/126021,http://my.oschina.net/feichexia/blog/126017,http://my.oschina.net/sansom/blog/125735,http://my.oschina.net/zino/blog/125689,http://my.oschina.net/luozheng/blog/125652,http://my.oschina.net/jsmagic/blog/125456,http://my.oschina.net/wchen/blog/125156,http://my.oschina.net/moooofly/blog/124950,http://my.oschina.net/lifj/blog/124795,http://www.ostools.net,http://www.ostools.net/apidocs,http://www.ostools.net/apidocs,http://runjs.cn/,http://runjs.cn/,http://www.ostools.net/regex,http://www.ostools.net/regex,http://www.ostools.net/encrypt,http://www.ostools.net/encrypt,http://www.ostools.net/jscompress,http://www.ostools.net/jscompress,http://www.oschina.net/events,http://www.oschina.net/app,http://www.oschina.net/app,http://www.oschina.net/app,http://my.oschina.net/kone/blog/119137,http://www.ostools.net/,http://runjs.cn/,http://www.nihao.net/domain/default.asp,http://www.jpush.cn/,http://www.cyz.org.cn/,http://www.leiphone.com/,http://www.wooyun.org/,http://openpk.org/,http://techbbs.zol.com.cn/,http://os.51cto.com/,http://bbs.51cto.com/,http://blog.nosqlfan.com/,http://www.cocoachina.com/,http://code.ijinshan.com/,http://www.hostucan.cn/,http://www.techtarget.com.cn,http://www.lupaworld.com/,http://www.ltesting.net/,http://huihoo.org/,http://www.chinaitlab.com/,http://www.osphp.com.cn/,http://oss.org.cn/,http://www.embeddedlinux.org.cn/,http://www.phpfans.net/,http://www.codefans.net/,http://www.mscto.com/,http://www.j2megame.org/,http://www.zendchina.net/,http://www.linuxsky.org/,http://www.linuxpk.com/,http://bbs.phpchina.com/,http://www.sxsoft.com/,http://bbs.jquery.org.cn/,http://china.templatemonster.com/,http://www.downcodes.com/,http://www.ddong.com/,http://www.linuxtone.org/,http://www.linux521.com/,http://xiexiejiao.cn/,http://www.php100.com/,http://linux.ubuntu.org.cn/,http://www.androidsphere.net/,http://www.foreveross.com/,http://www.magentochina.org/,http://www.phpbest.com/,http://www.apkbus.com/,http://qiniutek.com/,http://www.eoe.cn/,http://www.oschina.net/home/about,http://www.oschina.net/ailto:oschina.net@gmail.com,http://weibo.com/oschina2010,http://m.oschina.net/,http://www.miitbeian.gov.cn/,http://www.oschina.net/app,http://www.oschina.net/app,http://www.oschina.net/app,http://www.oschina.net/avascript:;,http://www.oschina.net/avascript:;',";
	
	response.writeHead(200, {"Content-Type": "text/html;charset=utf-8"});
    response.write(seeds);
    response.end();
}

exports.saveData=saveData;
exports.start=start;
exports.returnSeeds=returnSeeds;
